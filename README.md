# 背景 #
现代数据库存储引擎所面临的读写场景大致可以分为两类：读多写少和写多读少，读多写少的场景主要采用基于B+树的数据库，例如MySQL，而写多读少的场景则主要是采用本项目的主角：LSM-Tree，代表的产品是RocksDB

# 需求分析 #
对于写多读少的场景，影响系统整体效率的最关键因素就是写操作时延，传统的磁盘写方式是随机写，就是根据KV对信息找到数据存放在磁盘的位置然后进行数据更新

这种方式在每次写操作时都需要磁头进行寻道，当写请求数量变得无比庞大时，写请求的响应时延就很低

解决这个问题的方法很简单，就是采用追加写的方式，每一次写入数据都会在文件的末尾追加一个新的KV对，这就避免了磁头的寻道，提高了写操作的效率

但这样做也会带来一些坏处，主要有两点：数据冗余和读性能低

追加写会导致同一组KV对存储多个冗余记录，除了最后一个此前所有记录都是无用的，在极端情况下，只需一个KV对记录，进行无限次的写操作就会占满整个磁盘空间

另一个问题就是读性能降低，因为每一次查询都需要从后向前回溯，直到找到最新的KV数据记录，这样操作的最坏时间复杂度是O(N)，显然无法满足需求

#  方案设计 #
